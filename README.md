# ELMo Embeddings for Medica transcriptions
To convert Optum's Medica speech transcriptions to ELMo embeddings per sentence for clustering.

## Requirements:
 * Python3 (>=3.6)
 * AllenNLP
 * TensorFlow
 * NumPy
 * SKLearn (for clustering)
 * Torch

## Install
To install the necessary dependencies:

```bash
apt-get install python3-pip
pip3 install allennlp
pip3 install tensorflow-gpu
pip3 install numpy
pip3 install sklearn
pip3 install torch
```

Or to run inside a Docker container:
```bash
docker build -t elmo-embeddings .
docker exec -i -t elmo-embeddings /bin/bash
python3.6 main.py
```

## Usage
To generate sentence embeddings, make sure that the input.txt file is formatted as such:

```bash
file_name,file_size,transcription
a.txt,1,transcription a
b.txt,2,transcription b
# and so on...
```

To generate embeddings, run `python3 main.py`.
 * `-e <filename>` to specify which transcription file to embed
 * `-c <clustering>` to specify which clustering algorithm to use
 * `-v` to specify whether to use t-SNE for 3-d visualization
 * `-t` to specify whether to set up TensorBoard visualization


## Outputs
An output folder will be created in the current directory containing:
 * `embeddings.npy`: a NumPy array of sentence embeddings (NumPy arrays) in binary format
 * `sentences.txt`: a list of all sentences

 * `ms_labels.json`: a list of cluster labels generated by MeanShift
 * `db_labels.json`: a list of core labels generated by DBSCAN
 * `op_labels.json`: a list of core labels generated by OPTICS
 * `embeddings_ts.npy`: a NumPy array of sentence embeddings after t-SNE

 * `metadata.tsv`: metadata of sentence labels for visualization


## TO-DO
 - [x] Preprocess and clean transcriptions
 - [x] Embed each sentence with ELMo and reduce to column vector
 - [x] Store/export embeddings
 - [x] Cluster in program using SKLearn (MeanShift, DBSCAN, OPTICS)
 - [x] Create metadata
 - [x] Use TensorBoard for visualization
 - [ ] Conclusions
